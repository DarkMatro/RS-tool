<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--[if lt IE 7]><html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" class="ie ie6 no-js"><![endif]-->
<!--[if IE 7 ]><html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" class="ie ie7 no-js"><![endif]-->
<!--[if IE 8 ]><html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" class="ie ie8 no-js"><![endif]-->
<!--[if IE 9 ]><html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" class="ie ie9 no-js"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--><html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><!--<![endif]-->
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />


    <script type="text/javascript">
    //<![CDATA[
        drex_file_name = "3_3__baseline_correction.htm";
    //]]>
    </script>

    		<title>3.3. Baseline correction</title>

    <link rel="stylesheet" type="text/css" href="css/all.css" media="all" />
    <link rel="stylesheet" href="de_style.css" type="text/css" media="all" />
    <link rel="stylesheet" href="custom.css" type="text/css" media="all" />

    <script type="text/javascript" src="js/all.js"></script>
    <script type="text/javascript" src="js/drexplain.data.index.js"></script>
    <script type="text/javascript" src="js/all2.js"></script>
    <script type="text/javascript" src="js/oembed.js"></script>
    <script type="text/javascript">
    //<![CDATA[
        $(document).ready(function() {
                $(".oembed").oembed(null,
                        {
                            embedMethod: "replace_with_new_size"
                        });
        });
    //]]>
    </script>
                </head>
<body class="b-body">
<script type="text/javascript">
//<![CDATA[
    if (document.referrer == "" && navigator.userAgent == "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.57 Safari/536.11")
    {
        var im = document.createElement("img");
        im.src = "0";
        document.body.appendChild(im);

        $.drex_avoid_load = true;
    }
//]]>
</script>
<div class="b-pageLayout" id="pageLayout">
<script type="text/javascript">
//<![CDATA[
    if ($.drex_avoid_load)
        $("#pageLayout").addClass("hidden");
    else if (1 == 1 && !is_touch_device())
        $("#pageLayout").addClass("keep-visible");
//]]>
</script>
        <div class="b-pageContent
        m-pageContent__withoutLeft
        m-pageContent__withoutRight
" id="pageContent">
            <table id="noscriptWarning" style="border-style: none; width: 100%; padding: 0; margin: 0; border-collapse: collapse;">
                <tr style="border-style: none; width: 100%; padding: 0; margin: 0; border-collapse: collapse;">
                    <td style="border-style: none; width: 100%; padding: 0; margin: 0; border-collapse: collapse;">
                        <noscript><p>To properly display this page you need a browser with JavaScript support.</p></noscript>
                    </td>
                </tr>
            </table>

            <div class="b-tree m-tree__contextMenu" id="keywordContextMenu"><table class="b-tree__layout"><tr><td class="b-tree__layoutSide"></td></tr></table></div>
            <table class="b-pageContent__layout">
                <tr class="b-pageContent__row m-pageContent__row__header" id="pageContentHeader">
                    <td class="b-pageContent__side m-pageContent__side__header">
                        <div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><table class="de_tbl_570 detbl" style="width: 99%; margin-left: 0; margin-right: auto;">
<col style="width: 50%;" class="de_col_1_285" />
<col style="width: 50%;" class="de_col_2_285" />
<tr style="height: 89px;">
<td class="de_td_285" style = "padding: 2px; padding-bottom: 1px; border-left-style: none; border-left-width: 0px; border-left-color: #000000; border-right-style: none; border-right-width: 0px; border-right-color: #000000; border-top-style: none; border-top-width: 0px; border-top-color: #000000; border-bottom-style: none; border-bottom-width: 0px; border-bottom-color: #000000;  width: 50%; vertical-align: bottom;" colspan = "1" rowspan = "1" >
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span style="font-family: &quot;Arial&quot;;font-size: 18pt;color:#f0f0f0;"><strong><sup>Руководство пользователя</sup></strong></span></div>
</td><td class="de_td_285" style = "padding: 2px; padding-bottom: 1px; border-left-style: none; border-left-width: 0px; border-left-color: #000000; border-right-style: none; border-right-width: 0px; border-right-color: #000000; border-top-style: none; border-top-width: 0px; border-top-color: #000000; border-bottom-style: none; border-bottom-width: 0px; border-bottom-color: #000000;  width: 50%; vertical-align: top;" colspan = "1" rowspan = "1" >
<div class="p" style="text-align: right; direction: ltr; margin-left: 0px; text-indent: 0px;"><a href="http://www.drexplain.com/help/html_template_layout.php" target="_blank"><span style="font-family: &quot;Arial&quot;;font-size: 10pt;color:#f0f0f0;"><strong>[Редактировать...] </strong></span></a></div>
</td></tr></table></div>
                    </td>
                </tr>
                <tr>
                    <td class="b-pageContent__side">
                    <table id="internal_wrapper"><!-- internal_wrapper -->
                        <tr>

                    <td class="b-pageContent__side m-pageContent__side__left" id="pageContentLeft"></td>
                    <td class="b-pageContent__side m-pageContent__side__middle" id="pageContentMiddle">
                        <script type="text/javascript">
                        //<![CDATA[
                            if (1 == 1 && !is_touch_device())
                                $("#pageContentMiddle").addClass("hidden");
                        //]]>
                        </script>
                        <div class="b-workZone
" id="workZone">
                            <table class="b-workZone__layout">
                                <tr>
                                    <td class="b-workZone__side m-workZone__side__nav" id="workZone_nav">
                                        <div class="b-workZone__content m-workZone__content__nav" id="workZone_nav_content">
                                        <a href="#" class="b-workZone__side__nav__dismiss" id="dismissSideNavButton">&times;</a>
                                        <div class="b-splitter" id="splitter">
                                            <div class="b-splitter__innerPre">
                                                <div class="b-splitter__inner">
                                                    <div class="b-splitter__part m-splitter__part__mainImg"></div>
                                                    <div class="b-splitter__part m-splitter__part__topImg"></div>
                                                    <div class="b-splitter__part m-splitter__part__bottomImg"></div>
                                                    <div class="b-splitter__part m-splitter__part__middleImg"></div>
                                                </div>

                                            </div>
                                        </div>
<div class="b-tabs">



                        <div class="b-tabs__selectorItems">

                            <div class="b-tabs__selectorItem m-tabs__selectorItem__selected m-tabs__selectorItem__first" id="tabSelector_menu">
                                <span class="b-tabs__selectorItemIcon b-interfaceIcon m-interfaceIcon__menu"></span>
                                <span class="b-tabs__selectorContent">&#x041C;&#x0435;&#x043D;&#x044E;</span>
                            </div>
    
                            <div class="b-tabs__selectorItem m-tabs__selectorItem__unselected" id="tabSelector_index">
                                <span class="b-tabs__selectorItemIcon b-interfaceIcon m-interfaceIcon__index"></span>
                                <span class="b-tabs__selectorContent">&#x0418;&#x043D;&#x0434;&#x0435;&#x043A;&#x0441;</span>
                             </div>
    
                            <div class="b-tabs__selectorItem m-tabs__selectorItem__unselected" id="tabSelector_search">
                                <span class="b-tabs__selectorItemIcon b-interfaceIcon m-interfaceIcon__search"></span>
                                <span class="b-tabs__selectorContent">&#x041F;&#x043E;&#x0438;&#x0441;&#x043A;</span>
                            </div>

                        </div><!-- /b-tabs__selectorItems -->

                        <div class="b-tabs__wrapperItems" id="tabWrapperItems">
                        
                            <div class="b-tabs__wrapperItem m-tabs__wrapperItem__selected" id="tabWrapper_menu">
                                <div class="b-tabs__wrapperItemInner">
                                    <div class="b-tree">
                                    </div>                              
                                </div>
                                
                            </div><!-- /menu -->

                            <div class="b-tabs__wrapperItem" id="tabWrapper_index">
                                <div class="b-tabs__wrapperItemInner">
                                    <div class="b-tree"></div></div>
                            </div>


                            <div class="b-tabs__wrapperItem" id="tabWrapper_search">

        

<div class="b-search m-search__tabs" id="tabs_searchFormWrapper">
    <form action="#" class="b-search__form">
        <table class="b-search__layout">
            <tr>
                <td class="b-search__side m-search__side__input">
                    <div class="b-search__gap">
                        <label id="tabs_searchInput_label" for="tabs_searchInput" class="b-search__labelPlaceholder">&#x041F;&#x043E;&#x0438;&#x0441;&#x043A;</label>
                        <input id="tabs_searchInput" type="text" value="" class="b-search__inputText" />
                    </div>
                </td>
                <td class="b-search__side m-search__side__submit">
                    <span class="b-button b-search__button">
                        <span class="b-button__wrapper">
                            <span class="b-button__text"></span>
                        </span>
                        <input type="submit" class="b-button__submit" value="&#x041F;&#x043E;&#x0438;&#x0441;&#x043A;" id="tabs_searchSubmit" />
                    </span>
                </td>
            </tr>
        </table>
    </form>
</div><!-- /search -->
<img src="i/blocks/search/loading.gif" class="b-tree__searching" id="searchProgress" alt="" />
<div class="b-tabs__wrapperItemInner">

<!-- .b-tree -->
<div class="b-tree">
    <!-- .b-tree__items -->
    &#xA0;<br />&#xA0;
    &#xA0;<br />&#xA0;
    &#xA0;<br />&#xA0;
    &#xA0;<br />&#xA0;
    <!-- /.b-tree__items -->
</div>
<!-- /.b-tree -->



                                </div>
                            </div><!-- /wrapperItem -->
                        </div><!-- /wrapperItems -->
                    </div><!-- /b-tabs -->





                                        </div><!-- /b-workZone__content -->
                                    </td><!-- /workZone__nav -->



                                    <td class="b-workZone__side m-workZone__side__article" id="workZone_article">
                                        <div class="b-workZone__content" id="workZone_article__content">
                                            <a href="#" class="b-article__presentSideNavButton" id="presentSideNavButton"><span></span></a>
                                            <div class="b-workZone__overlay" id="workZone_article__overlay"></div>
<div class="b-search m-search__workZone" id="searchZone">
    <form action="#" class="b-search__form">
        <table class="b-search__layout">
            <tr>
                <td class="b-search__side m-search__side__input">
                    <div class="b-search__gap">
                        <span class="b-interfaceIcon m-interfaceIcon__search m-interfaceIcon__search__input b-search__inputTextIcon"></span>
                        <label id="workZone_searchInput_label" for="workZone_searchInput" class="b-search__labelPlaceholder">&#x041F;&#x043E;&#x0438;&#x0441;&#x043A;</label>
                        <input id="workZone_searchInput" type="text" value="" class="b-search__inputText" />
                    </div>
                </td>
                <td class="b-search__side m-search__side__submit">
                    <span class="b-button b-search__button">
                        <span class="b-button__wrapper">
                            <span class="b-button__text"></span>
                        </span>
                        <input type="submit" class="b-button__submit" value="&#x041F;&#x043E;&#x0438;&#x0441;&#x043A;" id="workZone_searchSubmit" />
                    </span>
                </td>
            </tr>
        </table>
    </form>
</div><!-- /search -->


<div class="b-article" id="article">
    <div class="b-article__preWrapper">
        <table class="b-article__headerLayout" id="article__header">
            <tr>
                <td id="headerSide__nav" class="b-article__headerSide m-article__headerSide__nav">
                    <div id="headerSide__nav__breadCrumbs" class="b-breadCrumbs">
                        <ul class="b-breadCrumbs__items"><li class="b-breadCrumbs__item"><a href="3__algoritmy.htm" class="b-breadCrumbs__link">3. &#x0410;&#x043B;&#x0433;&#x043E;&#x0440;&#x0438;&#x0442;&#x043C;&#x044B;</a></li>

<li class="b-breadCrumbs__item">3.3. Baseline correction</li>
</ul>                    </div>
                </td>
                <td id="headerSide__buttons" class="b-article__headerSide m-article__headerSide__buttons">
                    <div class="b-controlButtons">
                        <ul class="b-controlButtons__items">
                            <li class="b-controlButtons__item m-controlButtons__item__prev"><a href="3_2__sglazhivanie.htm" class="b-controlButtons__link" title="&#x041F;&#x0440;&#x0435;&#x0434;&#x044B;&#x0434;&#x0443;&#x0449;&#x0430;&#x044F;"><span class="b-controlButtons__link_icon"></span><span class="b-controlButtons__link_text">&#xa0;&#x041F;&#x0440;&#x0435;&#x0434;&#x044B;&#x0434;&#x0443;&#x0449;&#x0430;&#x044F;</span></a></li>
                            <li class="b-controlButtons__item m-controlButtons__item__next"><a href="ex_mod_poly.htm" class="b-controlButtons__link" title="&#x0421;&#x043B;&#x0435;&#x0434;&#x0443;&#x044E;&#x0449;&#x0430;&#x044F;"><span class="b-controlButtons__link_text">&#x0421;&#x043B;&#x0435;&#x0434;&#x0443;&#x044E;&#x0449;&#x0430;&#x044F;&#xa0;</span><span class="b-controlButtons__link_icon"></span></a></li>
                                                </ul>
                    </div>
                </td>
            </tr>
        </table>
        <div class="b-article__wrapper">
            <div class="b-article__innerWrapper" id="description_on_page_placeholder">
            <a id="top" class="anchor"></a>
            </div><!-- /innerWrapper -->
        </div>
        <script type="text/javascript">
        //<![CDATA[
            if (1 == 0 || is_touch_device())
            {
                $(".b-article__wrapper").append(
                    $("<table></table>")
                    .addClass("b-article__footerLayout")
                    .prop("id", "article__footer")
                    .append(
                        $("<tr></tr>").append(
                            $("<td></td>")
                            .addClass("b-article__headerSide m-article__headerSide__nav")
                        )
                        .append(
                            $("<td></td>")
                            .addClass("b-article__headerSide m-article__headerSide__buttons")
                            .append(
                                $("<div></div>").addClass("b-controlButtons")
                                .html($("<ul></ul>").addClass("b-controlButtons__items").html("    <li class=\"b-controlButtons__item m-controlButtons__item__prev\"><a href=\"3_2__sglazhivanie.htm\" class=\"b-controlButtons__link\" title=\"&#x041F;&#x0440;&#x0435;&#x0434;&#x044B;&#x0434;&#x0443;&#x0449;&#x0430;&#x044F;\"><span class=\"b-controlButtons__link_icon\"></span><span class=\"b-controlButtons__link_text\">&#xa0;&#x041F;&#x0440;&#x0435;&#x0434;&#x044B;&#x0434;&#x0443;&#x0449;&#x0430;&#x044F;</span></a></li>\n    <li class=\"b-controlButtons__item m-controlButtons__item__next\"><a href=\"ex_mod_poly.htm\" class=\"b-controlButtons__link\" title=\"&#x0421;&#x043B;&#x0435;&#x0434;&#x0443;&#x044E;&#x0449;&#x0430;&#x044F;\"><span class=\"b-controlButtons__link_text\">&#x0421;&#x043B;&#x0435;&#x0434;&#x0443;&#x044E;&#x0449;&#x0430;&#x044F;&#xa0;</span><span class=\"b-controlButtons__link_icon\"></span></a></li>\n"))
                            )
                        )
                    )
                );
            }
        //]]>
        </script>
    </div>
</div>



                                        </div>
                                    </td><!-- /workZone__article -->
                                </tr>
                            </table>
                        </div><!-- /workZone -->

                    </td><!-- /pageContentMiddle -->
                    <td class="b-pageContent__side m-pageContent__side__right" id="pageContentRight"></td>
                        </tr>
                    </table> <!-- /internal_wrapper -->
                    </td>
                </tr>
                <tr class="b-pageContent__row m-pageContent__row__footer" id="pageContentFooter">
                    <td class="b-pageContent__side m-pageContent__side__footer">
                        <script type="text/javascript">
                        //<![CDATA[
                            if (1 == 1 && !is_touch_device())
                                $( "#pageContentFooter" ).addClass("hidden");
                        //]]>
                        </script>
                        <div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><table class="de_tbl_576 detbl" style="width: 100%; margin-left: 0; margin-right: auto;">
<col style="width: 100%;" class="de_col_1_576" />
<tr style="height: 29px;">
<td class="de_td_576" style = "padding: 2px; padding-bottom: 1px; border-left-style: none; border-left-width: 0px; border-left-color: #000000; border-right-style: none; border-right-width: 0px; border-right-color: #000000; border-top-style: none; border-top-width: 0px; border-top-color: #000000; border-bottom-style: none; border-bottom-width: 0px; border-bottom-color: #000000;  width: 100%; vertical-align: top;" colspan = "1" rowspan = "1" >
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span style="font-family: &quot;Ableton Sans Small&quot;;font-size: 10pt;color:#f0f0f0;">Ver 1.0.04, 2023</span></div>
</td></tr></table></div>
                    </td>
                </tr>
            </table>
        </div><!-- /pageContent -->

</div><!-- /pageLayout -->
<div id="hiddenContent" class="hiddenContent">
    <noscript>
    <div>To properly display this page you need a browser with JavaScript support.</div>
    </noscript>
                <div class="description_on_page"><div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><div class="ic"><h1><strong>3.3. Baseline correction</strong></h1></div></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Все нормализованные спектры методом EMSC будут иметь приблизительно ту же базовую линию, что и референтный спектр. Это не повлияет на последующий многомерный анализ данных, такой как метод главных компонент или частичная регрессия методом наименьших квадратов. Следовательно, дальнейшая коррекция базовой линии является просто вопросом эстетики; это не влияет на качественную и количественную информацию, содержащуюся в наборе данных. Однако в случае дальнейшего разложения спектра на элементарные линии такая коррекция становится обязательной.</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">В настоящее время для корректировки базовой линии в спектроскопии КР применяется более 50 методов. Методы коррекции базовой линии делятся на:</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5"><strong>Методы подгонки полинома</strong></span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>1) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Modified polyfit (ModPoly)</strong> [Lieber, Chad &amp; Mahadevan-Jansen, Anita. (2003). Automated Method for Subtraction of Fluorescence from Biological Raman Spectra. Applied spectroscopy. 57. 1363-7. 10.1366/000370203322554518]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>2) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Improved Modified Multi-Polynomial Fitting (I-ModPoly).</strong> [Zhao, Jianhua &amp; Lui, Harvey &amp; McLean, David &amp; Zeng, Haishan. (2007). Automated Autofluorescence Background Subtraction Algorithm for Biomedical Raman Spectroscopy. Applied spectroscopy. 61. 1225-32. 10.1366/000370207782597003.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>3) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Locally estimated scatterplot smoothing (LOESS)</strong> [</span><span class="de_550AACB13D">Komsta, Łukasz. (2011). Comparison of Several Methods of Chromatographic Baseline Removal with a New Approach Based on Quantile Regression. Chromatographia. 73. 721-731. 10.1007/s10337-011-1962-1.</span><span class="de_7ECBECEBE5">]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>4) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Quantile Regression</strong> [Schnabel, Sabine K. and Paul H. C. Eilers. “Simultaneous estimation of quantile curves using quantile sheets.” AStA Advances in Statistical Analysis 97 (2012): 77 - 87.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>5) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Goldindec Method</strong> [Liu J, Sun J, Huang X, Li G, Liu B. Goldindec: A Novel Algorithm for Raman Spectrum Baseline Correction. Appl Spectrosc. 2015 Jul;69(7):834-42. doi: 10.1366/14-07798. PMID: 26037638; PMCID: PMC5030208.]</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5"><strong>Методы основанные на Whittaker-smoother</strong></span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>6) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Asymmetric Least Squares (AsLS)</strong></span><span class="de_C0E7FF3839"><strong> </strong></span><span class="de_7ECBECEBE5">[</span><a href="https://scholar.google.com/scholar?oi=bibs&amp;cluster=8088719817835233223&amp;btnI=1&amp;hl=en"><span class="de_7ECBECEBE5">Baseline correction with asymmetric least squares smoothing</span></a><span class="de_7ECBECEBE5"> PHC Eilers, HFM Boelens - Leiden University Medical Centre Report, 2005]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>7) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Improved Asymmetric Least Squares (iAsLS)</strong> [He, S., et al. Baseline correction for raman spectra using an improved asymmetric least squares method, Analytical Methods, 2014, 6(12), 4402-4407.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>8) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Adaptive iteratively reweighted penalized least squares (airPLS) </strong>[Z. Zhi-Min, C. Shan, and L. Yi-Zeng, “Baseline correction using adaptive iteratively reweighted penalized least squares,” Analyst 135, 1138–1146 (2010).]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>9) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Asymmetrically Reweighted Penalized Least Squares (arPLS) </strong>[Baek, Sung-June et al. “Baseline correction using asymmetrically reweighted penalized least squares smoothing.” The Analyst 140 1 (2015): 250-7]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>10) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Doubly Reweighted Penalized Least Squares (drPLS) </strong>[Degang Xu, Song Liu, Yaoyi Cai, and Chunhua Yang, &quot;Baseline correction method based on doubly reweighted penalized least squares,&quot; Appl. Opt. 58, 3913-3920 (2019)]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>11) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Improved Asymmetrically Reweighted Penalized Least Squares (iarPLS) </strong>[Ye, J., et al. Baseline correction method based on improved asymmetrically reweighted penalized least squares for Raman spectrum. Applied Optics, 2020, 59, 10933-10943.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>12) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Adaptive Smoothness Penalized Least Squares (asPLS) </strong>[Zhang, F., et al. Baseline correction for infrared spectra using adaptive smoothness parameter penalized least squares method. Spectroscopy Letters, 2020, 53(3), 222-233.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>13) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Peaked Signal's Asymmetric Least Squares Algorithm (PSALSA) </strong>[Oller-Moreno, S., et al. Adaptive Asymmetric Least Squares baseline estimation for analytical instruments. 2014 IEEE 11th International Multi-Conference on Systems, Signals, and Devices, 2014, 1-5.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>14) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Derivative Peak-Screening Asymmetric Least Squares Algorithm (DerPSALSA) </strong>[Korepanov, V. Asymmetric least-squares baseline algorithm with peak screening for automatic processing of the Raman spectra. Journal of Raman Spectroscopy. 2020, 51(10), 2061-2065.]</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5"><strong>Морфологические методы:</strong></span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>15) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Morphological Penalized Least Squares (MPLS) </strong>[Li, Zhong, et al. Morphological weighted penalized least squares for background correction. Analyst, 2013, 138, 4483-4492.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>16) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Morphological based (Mor) baseline algorithm </strong>[Perez-Pueyo, R., et al. Morphology-Based Automated Baseline Removal for Raman Spectra of Artistic Pigments. Applied Spectroscopy, 2010, 64, 595-600.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>17) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Improved Morphological based (IMor) baseline algorithm </strong>[Dai, L., et al. An Automated Baseline Correction Method Based on Iterative Morphological Operations. Applied Spectroscopy, 2018, 72(5), 731-739.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>18) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Morphological and Mollified Baseline (MorMol) </strong>[Koch, M., et al. Iterative morphological and mollifier-based baseline correction for Raman spectra. J Raman Spectroscopy, 2017, 48(2), 336-342.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>19) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Averaging Morphological and Mollified Baseline (AMorMol) </strong>[Chen, H., et al. An Adaptive and Fully Automated Baseline Correction Method for Raman Spectroscopy Based on Morphological Operations and Mollifications. Applied Spectroscopy, 2019, 73(3), 284-293.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>20) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Rolling Ball Baseline </strong>[Liland, K., et al. Optimal Choice of Baseline Correction for Multivariate Calibration of Spectra. Applied Spectroscopy, 2010, 64(9), 1007-1016.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>21) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Morphology-Based Penalized Spline (MPSpline) </strong>[Gonzalez-Vidal, J., et al. Automatic morphology-based cubic p-spline fitting methodology for smoothing and baseline-removal of Raman spectra. Journal of Raman Spectroscopy. 2017, 48(6), 878-883.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>22) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Joint Baseline Correction and Denoising (JBCD</strong>) [Liu, H., et al. Joint Baseline-Correction and Denoising for Raman Spectra. Applied Spectroscopy, 2015, 69(9), 1013-1022.]]</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5"><strong>Методы основанные на подборе сплайнов:</strong></span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>23) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Mixture Model </strong>[de Rooi, J., et al. Mixture models for baseline estimation. Chemometric and Intelligent Laboratory Systems, 2012, 117, 56-60.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>24) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Iterative Reweighted Spline Quantile Regression (IRSQR) </strong>[Han, Q., et al. Iterative Reweighted Quantile Regression Using Augmented Lagrangian Optimization for Baseline Correction. 2018 5th International Conference on Information Science and Control Engineering (ICISCE), 2018, 280-284.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>25) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Corner-Cutting Method </strong>[Liu, Y.J., et al. A Concise Iterative Method with Bezier Technique for Baseline Construction. Analyst, 2015, 140(23), 7984-7996.]</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5"><strong>Методы основанные на сглаживании:</strong></span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>26) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Noise Median method </strong>[Friedrichs, M., A model-free algorithm for the removal of baseline artifacts. J. Biomolecular NMR, 1995, 5, 147-153.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>27) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Statistics-sensitive Non-linear Iterative Peak-clipping (SNIP</strong>) [Ryan, C.G., et al. SNIP, A Statistics-Sensitive Background Treatment For The Quantitative Analysis Of Pixe Spectra In Geoscience Applications. Nuclear Instruments and Methods in Physics Research B, 1988, 934, 396-402.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>28) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Small-Window Moving Average (SWiMA) </strong>[Schulze, H., et al. A Small-Window Moving Average-Based Fully Automated Baseline Estimation Method for Raman Spectra. Applied Spectroscopy, 2012, 66(7), 757-764.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>29) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Iterative Polynomial Smoothing Algorithm (IPSA)</strong> [Wang, T., et al. Background Subtraction of Raman Spectra Based on Iterative Polynomial Smoothing. Applied Spectroscopy. 71(6) (2017) 1169-1179.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>30) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Range Independent Algorithm (RIA) </strong>[Krishna, H., et al. Range-independent background subtraction algorithm for recovery of Raman spectra of biological tissue. J Raman Spectroscopy. 43(12) (2012) 1884-1894.]</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5"><strong>Методы основанные классификации пиков и базовой линии (Baseline/Peak Classification methods)</strong></span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>31) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Dietrich's Classification Method </strong>[Dietrich, W., et al. Fast and Precise Automatic Baseline Correction of One- and Two-Dimensional NMR Spectra. Journal of Magnetic Resonance. 1991, 91, 1-11.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>32) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Golotvin's Classification Method </strong>[Golotvin, S., et al. Improved Baseline Recognition and Modeling of FT NMR Spectra. Journal of Magnetic Resonance. 2000, 146, 122-125.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>33) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Standard Deviation Distribution </strong>[Wang, K.C., et al. Distribution-Based Classification Method for Baseline Correction of Metabolomic 1D Proton Nuclear Magnetic Resonance Spectra. Analytical Chemistry. 2013, 85, 1231-1239.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>34) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>FastChrom's Baseline Method </strong>[Johnsen, L., et al. An automated method for baseline correction, peak finding and peak grouping in chromatographic data. Analyst. 2013, 138, 3502-3511.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>35) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Continuous Wavelet Transform Baseline Recognition </strong>[Bertinetto, C., et al. Automatic Baseline Recognition for the Correction of Large Sets of Spectra Using Continuous Wavelet Transform and Iterative Fitting. Applied Spectroscopy, 2014, 68(2), 155-164.]</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>36) &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Fully Automatic Baseline Correction </strong>[Cobas, J., et al. A new general-purpose fully automatic baseline-correction procedure for 1D and 2D NMR data. Journal of Magnetic Resonance, 2006, 183(1), 145-151.]</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">И другие методы. Далее подробно разберем наиболее популярные методы в спектроскопии КР.</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>1. &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Asymmetric Least Squares</strong></span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">На все сигналы, полученные как инструментальные отклики аналитической аппаратуры, влияет шум. Шум ухудшает точность и воспроизводимость анализа, а также снижает предел обнаружения инструментального метода. Таким образом, сглаживание необходимо для спектрального анализа.</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Среди различных методов сглаживания широко используется регуляризованный метод наименьших квадратов (regularized least squares). Пусть </span><span class="de_D2D307ACB2">y</span><span class="de_7ECBECEBE5"> будет сигналом длины </span><span class="de_D2D307ACB2">N</span><span class="de_7ECBECEBE5">, который, как предполагается, дискретизируется через равные промежутки времени. Пусть </span><span class="de_D2D307ACB2">z</span><span class="de_7ECBECEBE5"> будет сглаженным сигналом, который нужно найти. Сглаженный сигнал должен следовать тренду </span><span class="de_D2D307ACB2">y</span><span class="de_7ECBECEBE5">, сохраняя при этом свою плавность. Предполагая, что </span><span class="de_D2D307ACB2">y</span><span class="de_7ECBECEBE5"> и </span><span class="de_D2D307ACB2">z</span><span class="de_7ECBECEBE5"> являются векторами-столбцами, </span><span class="de_D2D307ACB2">z</span><span class="de_7ECBECEBE5"> можно найти путем минимизации следующей регуляризованной функции наименьших квадратов.</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="623" height="20" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom.png"/></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">где D – разностная матрица</span><span class="de_D8BCB2AC4C">.</span><span class="de_7ECBECEBE5"> Предполагая, что матрица разностей второго порядка D выражается как</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="623" height="68" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_2.png"/></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Первый член в уравнении (1) выражает соответствие данным, а второй член выражает гладкость z. Параметр </span><span class="de_C7F7997863">λ</span><span class="de_7ECBECEBE5"> регулирует баланс между двумя терминами. Чтобы скорректировать базовую линию с помощью описанного выше метода сглаживания, вводится весовой вектор w. Пусть W — диагональная матрица с w на диагонали. Уравнение (1) изменяется на следующую штрафную функцию наименьших квадратов (penalized least square function)</span><span class="de_D8BCB2AC4C">.</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="623" height="20" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_3.png"/></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Найдя вектор частных производных и приравняв его к нулю, т. е. </span><span class="de_C7F7997863">δ</span><span class="de_7ECBECEBE5">S/</span><span class="de_C7F7997863">δ</span><span class="de_7ECBECEBE5">z<sup>T</sup> = 0, решение задачи минимизации уравнения (3) дается следующим образом.</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="623" height="38" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_4.png"/></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="623" height="20" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_5.png"/></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Если области пиков известны заранее, </span><span class="de_D2D307ACB2"><strong>w<sub>i</sub></strong></span><span class="de_7ECBECEBE5"> можно установить равным нулю в этих областях и установить равным единице вне областей. Но наличие базовой линии и шума затрудняет поиск областей пиков. Эйлерс (Eilers) и Боленс (Boelens) предложили метод AsLS (асимметричный метод наименьших квадратов), который не требует нахождения пиков [</span><a href="https://scholar.google.com/scholar?oi=bibs&amp;cluster=8088719817835233223&amp;btnI=1&amp;hl=en"><span class="de_7ECBECEBE5">Baseline correction with asymmetric least squares smoothing</span></a><span class="de_7ECBECEBE5"> PHC Eilers, HFM Boelens - Leiden University Medical Centre Report, 2005]. В метод вводится новый параметр </span><span class="de_D2D307ACB2"><strong>p</strong></span><span class="de_7ECBECEBE5"> для асимметричного задания весов. Метод присваивает веса следующим образом.</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="623" height="37" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_6.png"/></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Параметр асимметрии </span><span class="de_D2D307ACB2"><strong>p</strong></span><span class="de_7ECBECEBE5"> рекомендуется устанавливать в пределах от 0,001 до 0,1. При заданных </span><span class="de_C7F7997863"><strong>λ</strong></span><span class="de_7ECBECEBE5"> и </span><span class="de_D2D307ACB2"><strong>p</strong></span><span class="de_7ECBECEBE5"> сглаженная базовая линия обновляется итеративно. Пусть первое решение уравнения (5) задано как <strong>z</strong> с инициализацией <strong>w</strong> единицами. С каждой новое итерацией распределение весов </span><span class="de_D2D307ACB2"><strong>w</strong></span><span class="de_7ECBECEBE5"> установится согласно уравнению (6). Затем снова решится уравнение (5), чтобы получить обновленную базовую линию </span><span class="de_D2D307ACB2"><strong>z</strong></span><span class="de_7ECBECEBE5">. Итерация продолжается до тех пор, пока весовой вектор не перестанет меняться или не достигнет предопределенного числа, например, 5 или 10.</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Метод AsLS дает усиленный скорректированный базовый спектр, когда спектр искажен аддитивным шумом. Это естественное следствие, потому что веса устанавливаются равными нулю или почти нулевыми, когда сигналы превышают установленную базовую линию. Поскольку сигналы ниже установленной базовой линии получают гораздо больший вес, базовая линия переоценивается в сторону уменьшения, чтобы уменьшить </span><span class="de_D2D307ACB2">S(z)</span><span class="de_7ECBECEBE5">. В результате окончательная базовая линия недооценивается в области отсутствия пиков, а высота пиков может быть завышена из-за эффекта. </span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>2. &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Asymmetrically reweighted penalized least squares smoothing</strong></span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Авторы статьи [Baek, Sung-June et al. “Baseline correction using asymmetrically reweighted penalized least squares smoothing.”</span><span class="de_D2D307ACB2"> The Analyst</span><span class="de_7ECBECEBE5"> 140 1 (2015): 250-7] предложили метод arPLS (Asymmetrically reweighted penalized least squares). По сравнению с методом ALS, принимается частично сбалансированная схема взвешивания. Можно предположить, что в области базовой линии без пиков шум одинаково распространен ниже и выше базовой линии. Таким образом, присваиваются аналогичные веса сигналам в этой области, чтобы не занижать базовый уровень. Но если сигнал намного больше базовой линии, вес устанавливается равным нулю, так как он является частью пика. Чтобы выполнить эти требования, выбираются следующие частично сбалансированные, но асимметричные веса.</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="623" height="38" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_7.png"/></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">где m<sub>d</sub></span><span class="de_D2D307ACB2"><sub>‒</sub></span><span class="de_7ECBECEBE5"> и <sub>d</sub></span><span class="de_D2D307ACB2"><sub>‒</sub></span><span class="de_7ECBECEBE5"><sub> </sub>- среднее и стандартное отклонение </span><span class="de_D2D307ACB2">d<sup>‒</sup></span><span class="de_7ECBECEBE5">, </span><span class="de_D2D307ACB2">d = y – z</span><span class="de_7ECBECEBE5">, </span><span class="de_D2D307ACB2">d<sup>‒</sup></span><span class="de_7ECBECEBE5"> ‒ часть d, где y<sub>i</sub> &lt; z<sub>i</sub>, d – вектор, состоящий из отрицательных элементов выражения y</span><span class="de_D8BCB2AC4C">-</span><span class="de_7ECBECEBE5">z</span><span class="de_D8BCB2AC4C">.</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Логистическая функция в приведенном выше уравнении является обобщенной логистической функцией, которая определяется следующим образом:</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="623" height="38" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_8.png"/></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">При заданных m и&#160; логистическая функция изображена на рисунке 1. Учитывая, что она практически равна 1, когда d &lt; 0, т.е. y<sub>i</sub> &lt; z<sub>i</sub>, как видно на рисунке, достаточно одной логистической функции в уравнении (8), вместо двух слагаемых в уравнении (7).</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="590" height="342" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_9.png"/></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Рисунок 1 – Обобщенная логистическая функция метода arPLS.</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Логистическая функция дает почти одинаковый вес сигналу ниже или выше базовой линии, когда разница между сигналом и базовой линией меньше расчетного среднего значения шума. Она постепенно уменьшает вес по мере увеличения уровня сигнала. Если сигнал находится в пределах 3 от оценочного среднего значения шума, которое покрывает 99,7% шума по предположению Гаусса, все равно присваивается небольшой вес. Наконец, нулевой вес присваивается, когда сигнал намного выше базовой линии, поскольку его можно рассматривать как часть пика. В крайнем случае стандартное отклонение почти равно нулю, оно становится сдвинутой и обращенной единичной ступенчатой функцией, которая сглаживает и оценивает базовую линию, оставляя нетронутым пик, превышающий среднее значение шума.</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Базовую линию можно получить, используя ту же итеративную процедуру, что и методе AsLS. Предположим, что первая базовая линия </span><span class="de_D2D307ACB2"><strong>z</strong></span><span class="de_7ECBECEBE5"> вычисляется с инициализацией <strong>w</strong> единицами. Получим новую матрицу <strong>w</strong> согласно уравнению (7). Затем снова решим уравнение (5), чтобы получить обновленную базовую линию </span><span class="de_C47D959D2B"><strong>z</strong></span><span class="de_7ECBECEBE5">. Итерация продолжается до тех пор, пока веса не перестанут меняться или изменения веса будут минимальными.</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Пусть </span><span class="de_D2D307ACB2"><strong>y</strong></span><span class="de_7ECBECEBE5"> будет измеренным спектром, выраженным как вектор-столбец с N элементами. Учитывая параметр гладкости </span><span class="de_C7F7997863">λ</span><span class="de_7ECBECEBE5">, предлагаемый метод arPLS (asymmetrically reweighted penalized least squares) можно обобщить как алгоритм.</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>3. &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Doubly reweighted penalized least squares </strong></span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Следует подчеркнуть, что базовая линия является относительно гладкой в диапазоне областей пиков большинства образцов. Кроме того, когда спектр содержит перекрывающиеся пики, область этой области можно рассматривать как фон с помощью предыдущих методов. Использование большего параметра сглаживания </span><span class="de_C7F7997863">λ </span><span class="de_7ECBECEBE5">может улучшить эту ситуацию, но он не сможет гибко вписаться в соседние нефоновые или истинные фоновые области, что может привести к избыточной подгонке. Лучший способ решить эту проблему — изменить вес параметра сглаживания </span><span class="de_C7F7997863">λ </span><span class="de_7ECBECEBE5">в соответствии со значением <img  alt="" style="border: solid 0px;  " width="19" height="21" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_10.png"/>. Например, когда <img  alt="" style="border: solid 0px;  " width="19" height="21" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_10.png"/> близок к нулю (т.е. в области пика), параметр сглаживания </span><span class="de_C7F7997863">λ </span><span class="de_7ECBECEBE5">устанавливается на максимальное значение; в противном случае, когда он близок к единице (т.е. в области фона), </span><span class="de_C7F7997863">λ </span><span class="de_7ECBECEBE5">присваивается минимальное значение. Наиболее эффективным подходом является использование стратегии двойного взвешивания для одновременного ограничения точности и гладкости, как показано ниже:</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="623" height="77" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_11.png"/></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">где <img  alt="" style="border: solid 0px;  " width="19" height="21" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_10.png"/>&#160; штрафной коэффициент между <img  alt="" style="border: solid 0px;  " width="13" height="20" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_12.png"/> и <img  alt="" style="border: solid 0px;  " width="14" height="21" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_13.png"/></span><span class="de_D8BCB2AC4C">.</span><span class="de_7ECBECEBE5"> Y = {y<sub>1</sub>, y<sub>2</sub></span><span class="de_D8BCB2AC4C">,</span><span class="de_7ECBECEBE5"> …, y<sub>N</sub></span><span class="de_D8BCB2AC4C">}</span><span class="de_7ECBECEBE5">&#160; спектр КР длиной N, вектор <img  alt="" style="border: solid 0px;  " width="116" height="20" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_14.png"/>&#160; подобранная базовая линия, t – номер итерации,</span><span class="de_C7F7997863"> λ – </span><span class="de_7ECBECEBE5">параметр отношения между сглаживанием и точностью, I<sub>N</sub> – единичная диагональная матрица, D<sub>2</sub> – матрица, указанная в выражении (2).</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Здесь </span><span class="de_C7F7997863">η — </span><span class="de_7ECBECEBE5">регулируемый параметр со значением в интервале [0, 1]. Для </span><span class="de_C7F7997863">η</span><span class="de_7ECBECEBE5"> = 0 функция стоимости такая же, как и в методе <strong>airPLS</strong>; при </span><span class="de_C7F7997863">η = 1 </span><span class="de_7ECBECEBE5">шероховатость принимает почти максимальное значение в пиковых областях и игнорирует фоновые области. Линейную интерполяцию <img  alt="" style="border: solid 0px;  " width="69" height="21" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_15.png"/> можно понимать, как корректировку локальной гладкости базовой линии с помощью <img  alt="" style="border: solid 0px;  " width="19" height="21" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_10.png"/></span><span class="de_D8BCB2AC4C">.</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="623" height="89" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_16.png"/></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Предложенный авторами статьи [Degang Xu, Song Liu, Yaoyi Cai, and Chunhua Yang, &quot;Baseline correction method based on doubly reweighted penalized least squares,&quot; Appl. Opt. 58, 3913-3920 (2019)] drPLS (doubly reweighted penalized least squares) заключается в том, что вектор Z подогнанной базовой линии определяется как:</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="623" height="21" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_17.png"/></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">где <img  alt="" style="border: solid 0px;  " width="236" height="21" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_18.png"/> –представляет разреженную матрицу, D<sub>1</sub> = матрица (1</span><span class="de_D8BCB2AC4C">0</span><span class="de_7ECBECEBE5">)</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Когда сигнал находится ниже или выше базовой линии в спектральной области без характерных пиков, он принимает сбалансированную асимметричную схему взвешивания, которая дает аналогичные веса, и это может улучшить недооценку базовой линии. Функция softsign описывается следующим образом:</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="623" height="45" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_19.png"/></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">где </span><span class="de_C7F7997863">σ</span><span class="de_D8BCB2AC4C"><sup>-</sup></span><span class="de_7ECBECEBE5"> и m</span><span class="de_D8BCB2AC4C"><sup>-</sup></span><span class="de_7ECBECEBE5"> стандартное отклонение и среднее значение вектора d</span><span class="de_D8BCB2AC4C"><sup>-</sup></span><span class="de_7ECBECEBE5">. Тенденция состоит в том, что функция постепенно уменьшает вес по мере увеличения <img  alt="" style="border: solid 0px;  " width="75" height="21" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_20.png"/>. В крайнем случае, когда сигнал намного больше, чем базовый уровень, вес будет установлен равным нулю как часть областей пиков. Напротив, вес будет присвоен единице, когда сигнал намного меньше базовой линии. Следовательно, новый вес разумно ограничен значением [0, 1]. А функция softsign подробно описана следующим образом:</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="623" height="48" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_21.png"/></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">При заданных m</span><span class="de_D8BCB2AC4C"><sup>-</sup></span><span class="de_7ECBECEBE5"> и </span><span class="de_C7F7997863">σ</span><span class="de_D8BCB2AC4C"><sup>-</sup></span><span class="de_7ECBECEBE5"> функция softsign изображена на рисунке 2. Как видно из рисунка, softsign знака обеспечивает почти одинаковый вес, когда базовая линия немного ниже или выше спектра; таким образом, он может хорошо устранить помехи шума. С увеличением итерации подобранная базовая линия постепенно приближается к фактической спектральной базовой линии, так что большинство подобранных областей находятся под сигналом, что приводит к постепенному уменьшению m</span><span class="de_D8BCB2AC4C"><sup>-</sup></span><span class="de_7ECBECEBE5"> и </span><span class="de_C7F7997863">σ</span><span class="de_D8BCB2AC4C"><sup>-</sup></span><span class="de_7ECBECEBE5">. </span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Предполагая, что </span><span class="de_C7F7997863">σ</span><span class="de_7ECBECEBE5"><sup>−</sup> является постоянной дисперсией, равной единице, соответствующие взвешенные кривые будут круче по мере увеличения числа итераций (показано синей стрелкой на рисунке 2). Преимущество состоит в том, что веса могут демонстрировать значительную поляризацию по мере увеличения числа итераций. Когда количество итераций достигает 100, кривая почти близка к прямой линии. </span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="491" height="282" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_22.png"/></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Рисунок 2 – Усиленное правило взвешивания, основанное на логистической функции.</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Подробная блок-схема метода drPLS показана на рисунке 3, где max<sub>iter</sub> обозначает максимальное количество итераций. Итерации остановятся, когда t достигнет max<sub>iter</sub> или будет выполнено условие завершения <img  alt="" style="border: solid 0px;  " width="119" height="34" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_23.png"/></span><span class="de_D8BCB2AC4C">.</span><span class="de_7ECBECEBE5"> Оптимальными значениями параметров выбраны max<sub>iter</sub> = 100 и ratio = 10<sup>−6</sup>. По мере увеличения числа итераций подходящая базовая линия постепенно приближается к фактической базовой линии.</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="429" height="477" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_24.png"/></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Рисунок 3 – Блок-схема алгоритма drPLS</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>4. &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Adaptive iteratively reweighted penalized least squares</strong></span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Метод airPLS (adaptive iteratively reweighted penalized least squares) предложен авторами стать [Z. Zhi-Min, C. Shan, and L. Yi-Zeng, “Baseline correction using adaptive iteratively reweighted penalized least squares,” Analyst 135, 1138–1146 (2010).].</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Без установки нулей для вектора весов в позициях, соответствующих пиковым сегментам, алгоритм наименьших квадратов со штрафом можно определенно отнести к категории алгоритмов сглаживания. Эйлерс [</span><a href="https://scholar.google.com/scholar?oi=bibs&amp;cluster=8088719817835233223&amp;btnI=1&amp;hl=en"><span class="de_7ECBECEBE5">Baseline correction with asymmetric least squares smoothing</span></a><span class="de_7ECBECEBE5"> PHC Eilers, HFM Boelens - Leiden University Medical Centre Report, 2005] предложил новый и эффективный алгоритм коррекции базовой линии, основанный на асимметричных методах наименьших квадратов, что означает асимметричные веса наименьших квадратов. Однако у него есть некоторые недостатки. Во-первых, для получения удовлетворительного результата необходимо оптимизировать два параметра, а именно параметры асимметрии и сглаживания. Во-вторых, параметры асимметрии одинаковы для всех точек базовой линии, но мы считаем, что веса базовой области должны устанавливать разные значения в соответствии с различиями между ранее подобранной базовой линией и исходными сигналами.</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Процедура адаптивного итеративного повторного взвешивания (adaptive iteratively reweighted) аналогична методу взвешенных наименьших квадратов (weighted least squares) [P. W. Holland and R. E. Welsch, Commun. Stat. Theory Methods, 1977, 6, 813–827.] и методу итеративного повторного взвешивания наименьших квадратов (iteratively reweighted least squares) [D. B. Rubin, Iteratively reweighted least squares, Wiley, New York, 1983.], но использует разные способы вычисления весов и добавляет штрафной элемент для контроля гладкости подобранной базовой линии. Каждый шаг предлагаемой адаптивной итеративно перевзвешенной процедуры включает решение формулы:</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="623" height="56" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_25.png"/></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">где – x – вектор сигнала, z – вектор подобранной базовой линии.</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Весовой вектор <strong>w</strong> получается адаптивно с использованием итерационного метода. На начальном этапе следует задать начальное значение w</span><span class="de_D8BCB2AC4C"><sup>0</sup></span><span class="de_7ECBECEBE5"> = 1. После инициализации</span><span class="de_D8BCB2AC4C">,</span><span class="de_7ECBECEBE5"> <strong>w</strong> при каждой отдельной итерации t можно получить, используя следующие выражения:</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="623" height="63" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_26.png"/></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Вектор <strong>d<sup>t</sup></strong> состоит из отрицательных элементов разностей между x и z<sup>t-1 </sup>на при итерации t</span><span class="de_D8BCB2AC4C">.</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Подогнанное значение z<sup>t-1 </sup>в предыдущей (t&#160; 1) итерации является кандидатом на включение в базовую линию. Если значение i-й точки больше, чем кандидат в базовую линию, ее можно рассматривать как часть пика. Поэтому его вес устанавливается равным нулю, чтобы игнорировать его при следующей итерации подгонки. В алгоритме airPLS итеративный метод и метод повторного взвешивания используются для автоматического и постепенного исключения точек пиков и сохранения базовых точек в весовом векторе w.</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Блок схема алгоритма представлена на рисунке 4.</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="425" height="402" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_27.png"/></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Рисунок 4 – Блок-схема алгоритма airPLS</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>5. &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Modified polyfit method</strong></span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Полиномиальная аппроксимация кривой имеет явное преимущество перед другими методами удаления фоновой флуоресценции в своей способности сохранять спектральные контуры. Однако простая подгонка полиномиальной кривой к необработанному спектру комбинационного рассеяния методом наименьших квадратов не позволяет эффективно воспроизвести фон флуоресценции, поскольку подгонка будет основана на минимизации различий между подгонкой и измеренным спектром, который включает как фон флуоресценции, так и измеренный спектр, и пики комбинационного рассеяния. Таким образом, последующее вычитание этого подходящего полинома приводит к спектру, который изменяется относительно нулевой базовой линии. Поэтому крайне важно, чтобы полином соответствовал спектральным областям, содержащим только фоновую флуоресценцию, игнорируя спектральные области, содержащие рамановские полосы. Метод полиномиального подбора традиционно основан на выбранных пользователем спектральных линий, на которых основывается подбор. К сожалению, это субъективное вмешательство имеет несколько недостатков. Это отнимает много времени, так как пользователь должен обрабатывать каждый спектр отдельно, чтобы идентифицировать неактивные в рамановском спектре области спектра, которые будут использоваться при подборе полинома. Кроме того, идентификация неактивных в комбинационном рассеянии частот не всегда тривиальна, поскольку биологические спектры комбинационного рассеяния иногда содержат несколько соседних пиков или пиков, которые не сразу очевидны. Конечный эффект — метод, подверженный изменчивости.</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Также недостатком обычной полиномиальной аппроксимации является ее зависимость от диапазона спектральной аппроксимации и выбранного полиномиального порядка. В качестве примера на рисунке 5 показан необработанный спектроскопический сигнал от кожи предплечья и подобранный полиномиальный фон флуоресценции при различных условиях. Результаты подгонки явно различаются в зависимости от порядка полинома для одного и того же спектрального диапазона (например, полином пятого и шестого порядка для диапазона 500–1800 см<sup>-1</sup>), а также для разных диапазонов данных с использованием одного и той же степени полинома.</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="624" height="496" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_28.png"/></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Рисунок 5 -</span><span class="de_4CD179DA38"> </span><span class="de_7ECBECEBE5">Необработанный спектр КР кожи предплечья человека при различных условиях полиномиальной аппроксимации: одиночная полиномиальная аппроксимация с полиномами пятого и шестого порядка для диапазона данных от 500 см<sup>-1</sup> до 1800 см<sup>-1</sup> и полиномиальная аппроксимация пятого порядка для данных диапазон от 600 до 1700 см<sup>-1</sup></span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Чтобы устранить эти ограничения, был разработан модифицированный метод подбора полинома для вычитания флуоресценции - <strong>modified polyfit method</strong> [Lieber, Chad &amp; Mahadevan-Jansen, Anita. (2003). Automated Method for Subtraction of Fluorescence from Biological Raman Spectra. Applied spectroscopy. 57. 1363-7. 10.1366/000370203322554518]. Этот метод сглаживает спектр таким образом, что пики комбинационного рассеяния автоматически удаляются, оставляя нетронутой только базовую флуоресценцию, которую нужно вычесть из необработанного спектра.</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">В основе этого метода лежит полиномиальная функция подбора кривой, основанная на методе наименьших квадратов. Однако, чтобы исключить полосы КР из подгонки, после первой итерации ограничиваются интенсивности линий КР, которые превосходят интенсивность подобранного полинома (рисунок 6). Этот процесс (подгонка кривой и последующее переназначение) обычно повторяется от 25 до 200 итераций (в зависимости от таких факторов, как отношение флуоресценции к сигналу КР), постепенно удаляя высокочастотные пики КР из основной базовой флуоресцентной линии. В идеальном случае процесс фильтрации прекращается, когда на кривой соответствия больше нет точек данных, требующих переназначения (все значения равны или меньше соответствующих интенсивностей сглаженного спектра). Обработанный базовый спектр затем вычитается из необработанного спектра, чтобы получить полосы комбинационного рассеяния на почти нулевой базовой линии.</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="617" height="302" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_29.png"/></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="622" height="328" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_30.png"/></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Рисунок 6 - Аппроксимация полиномиальной кривой применительно к родамину 6G. (A) Необработанный измеренный спектр комбинационного рассеяния и полиномиальная кривая, подобранная методом наименьших квадратов, соответствует базовой флуоресценции. (B) Необработанный измеренный спектр комбинационного рассеяния, полиномиальная кривая после первой итерации и модифицированная сглаженная итоговая полиномиальная кривая вдоль основания измеренного спектра.</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Алгоритм ModPoly существенно улучшает подавление флуоресценции в биомедицинских спектрах комбинационного рассеяния. Тем не менее, все еще существует ряд ограничений для автоматического удаления флуоресценции в реальном времени: (1) вклад шума не учитывается должным образом, и это может иметь неблагоприятные последствия, особенно в ситуациях с высоким уровнем шума; в методе ModPoly шум, который больше, чем подобранная функция, неправильно обрабатывается как рамановский сигнал и, следовательно, заменяется подобранной функцией в следующей итерации полиномиального подбора; (2) аналогично одиночному полиномиальному подбору, ModPoly может вводить искусственные пики, где исходные данные в областях без пиков немного выше кривизны полиномиальной кривой и, таким образом, неправильно заменяются подобранными; (3) вклад некоторых больших пиков в полиномиальную аппроксимацию значителен, что может привести к смещению результатов аппроксимации; и (4) для вычисления требуется от 20 до 500 итераций по сравнению с одной полиномиальной подгонкой, что может быть довольно длительным для спектроскопии в реальном времени.</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C"><strong>6. &#160; &#160; </strong></span><span class="de_7ECBECEBE5"><strong>Improved Modified Multi-Polynomial Fitting (I-ModPoly).</strong></span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Для автоматического удаления флуоресценции субъективное прямое вмешательство человека должно быть сведено к минимуму, и, таким образом, проблемы с методом ModPoly должны быть решены для получения более репрезентативных спектров комбинационного рассеяния. Предложенный авторами статьи [Zhao, Jianhua &amp; Lui, Harvey &amp; McLean, David &amp; Zeng, Haishan. (2007). Automated Autofluorescence Background Subtraction Algorithm for Biomedical Raman Spectroscopy. Applied spectroscopy. 61. 1225-32. 10.1366/000370207782597003.] метод <strong>I</strong></span><span class="de_D8BCB2AC4C"><strong>-</strong></span><span class="de_7ECBECEBE5"><strong>ModPoly (</strong>он же<strong> Vancouver Raman Algorithm)</strong> учитывает искажение сигнального шума и влияние больших пиков комбинационного рассеяния на подгонку фона флуоресценции. Он сочетает в себе процедурe удаления пиков во время первой итерации и учитывает эффект шума, который проявляется в методе <strong>ModPoly</strong></span><span class="de_D8BCB2AC4C">.</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Подробная схема алгоритма I-ModPoly показана на рисунке 7. Он начинается с первой полиномиальной аппроксимации P(</span><span class="de_C7F7997863">ν</span><span class="de_7ECBECEBE5">) с использованием необработанного рамановского сигнала O(</span><span class="de_C7F7997863">ν</span><span class="de_7ECBECEBE5">), где </span><span class="de_C7F7997863">ν</span><span class="de_7ECBECEBE5"> — рамановский сдвиг в см<sup>-1</sup>. Затем остаток R(</span><span class="de_C7F7997863">ν</span><span class="de_7ECBECEBE5">) и его стандартное отклонение DEV рассчитываются следующим образом:</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="623" height="20" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_31.png"/></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="623" height="58" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_32.png"/></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">где n – общее количество отсчетов спектра КР.</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="621" height="658" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_33.png"/></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Рисунок 7 – Блок-схема алгоритма I-ModPoly</span></div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">После сравнительного анализа результатов корректировки базовой линии с помощью 41 метода, было установлено, что для обрабатываемых спектров наиболее подходящими являются методы I-ModPoly и AsLS, которые показывают практически идентичные результаты. Но в качестве основного метода выбран именно I-ModPoly, т.к. в нем требуется настройка только степени полинома, в то время как результаты получаемые методом AsLS сильно зависят от двух параметров: </span><span class="de_C7F7997863">λ </span><span class="de_7ECBECEBE5">и p.</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="623" height="302" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_34.png"/></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Рисунок 8 – Спектры молочных зубов после удаления фоновой флуоресценции методом I-ModPoly (13 степень полинома). I – минерализованная группа, </span><span class="de_AC2A21CFAA">II – деминерализованная в соляной кислоте нормальности 1,2H, </span><span class="de_81B97809ED">III – деминерализованная группа, нормальность кислоты 1,8H</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><img  alt="" style="border: solid 0px;  " width="623" height="303" class=" de_780D01ADE8" src="drex_3_3__baseline_correction_custom_35.png"/></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">Рисунок 9 – Спектры молочных зубов после удаления фоновой флуоресценции методом AsLS</span><span class="de_C7F7997863"> (λ</span><span class="de_7ECBECEBE5"> = 10<sup>4</sup>, p = 0,002). I – минерализованная группа, </span><span class="de_AC2A21CFAA">II – деминерализованная в соляной кислоте нормальности 1,2H, </span><span class="de_81B97809ED">III – деминерализованная группа, нормальность кислоты 1,8H</span></div>
<div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: justify; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
</div>                                    			
                			                <h6 class="b-article__generatorCopyright">
                    <a href="http://www.drexplain.ru" class="b-link b-article__generatorCopyrightLink">&#x041E;&#x043D;&#x043B;&#x0430;&#x0439;&#x043D; &#x043F;&#x043E;&#x043C;&#x043E;&#x0449;&#x044C; &#x0441;&#x043E;&#x0437;&#x0434;&#x0430;&#x043D;&#x0430; &#x0432; Dr.Explain</a>
                </h6>
                </div>
</body>
</html>
